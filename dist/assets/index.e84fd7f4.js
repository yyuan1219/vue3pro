import{c as Q,d as U,q as le,Q as j,V as ce,b as d,k as T,aI as ue,aO as re,aP as ve,D as q,E as fe,i as de,j as he,a as P,t as I,n as V,U as D,aG as W,A as G,p as me,aQ as z,S as _,w as K,R as ge}from"./index.e03d35ab.js";import{u as we,a as L,o as pe}from"./index.9f046415.js";const[F,M]=Q("swipe"),ye={loop:I,width:V,height:V,vertical:Boolean,autoplay:D(0),duration:D(500),touchable:I,lazyRender:Boolean,initialSwipe:D(0),indicatorColor:String,showIndicators:I,stopPropagation:I},J=Symbol(F);var be=U({name:F,props:ye,emits:["change"],setup(a,{emit:C,slots:h}){const u=le(),e=j({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),l=we(),{children:m,linkChildren:O}=ce(J),i=d(()=>m.length),n=d(()=>e[a.vertical?"height":"width"]),r=d(()=>a.vertical?l.deltaY.value:l.deltaX.value),f=d(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-n.value*i.value:0),$=d(()=>Math.ceil(Math.abs(f.value)/n.value)),y=d(()=>i.value*n.value),w=d(()=>(e.active+i.value)%i.value),R=d(()=>{const t=a.vertical?"vertical":"horizontal";return l.direction.value===t}),Z=d(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(n.value){const s=a.vertical?"height":"width",o=a.vertical?"width":"height";t[s]=`${y.value}px`,t[o]=a[o]?`${a[o]}px`:""}return t}),ee=t=>{const{active:s}=e;return t?a.loop?_(s+t,-1,i.value):_(s+t,0,$.value):s},E=(t,s=0)=>{let o=t*n.value;a.loop||(o=Math.min(o,-f.value));let v=s-o;return a.loop||(v=_(v,f.value,0)),v},g=({pace:t=0,offset:s=0,emitChange:o})=>{if(i.value<=1)return;const{active:v}=e,c=ee(t),S=E(c,s);if(a.loop){if(m[0]&&S!==f.value){const k=S<f.value;m[0].setOffset(k?y.value:0)}if(m[i.value-1]&&S!==0){const k=S>0;m[i.value-1].setOffset(k?-y.value:0)}}e.active=c,e.offset=S,o&&c!==v&&C("change",w.value)},A=()=>{e.swiping=!0,e.active<=-1?g({pace:i.value}):e.active>=i.value&&g({pace:-i.value})},te=()=>{A(),l.reset(),z(()=>{e.swiping=!1,g({pace:-1,emitChange:!0})})},B=()=>{A(),l.reset(),z(()=>{e.swiping=!1,g({pace:1,emitChange:!0})})};let Y;const b=()=>clearTimeout(Y),x=()=>{b(),a.autoplay>0&&i.value>1&&(Y=setTimeout(()=>{B(),x()},+a.autoplay))},p=(t=+a.initialSwipe)=>{if(!u.value)return;const s=()=>{var o,v;if(!W(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((o=a.width)!=null?o:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=E(t),m.forEach(c=>{c.setOffset(0)}),x()};W(u)?G().then(s):s()},X=()=>p(e.active);let H;const ae=t=>{!a.touchable||(l.start(t),H=Date.now(),b(),A())},ie=t=>{a.touchable&&e.swiping&&(l.move(t),R.value&&(me(t,a.stopPropagation),g({offset:r.value})))},N=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-H,s=r.value/t;if((Math.abs(s)>.25||Math.abs(r.value)>n.value/2)&&R.value){const v=a.vertical?l.offsetY.value:l.offsetX.value;let c=0;a.loop?c=v>0?r.value>0?-1:1:0:c=-Math[r.value>0?"ceil":"floor"](r.value/n.value),g({pace:c,emitChange:!0})}else r.value&&g({pace:0});e.swiping=!1,x()},ne=(t,s={})=>{A(),l.reset(),z(()=>{let o;a.loop&&t===i.value?o=e.active===0?0:t:o=t%i.value,s.immediate?z(()=>{e.swiping=!1}):e.swiping=!1,g({pace:o-e.active,emitChange:!0})})},oe=(t,s)=>{const o=s===w.value,v=o?{backgroundColor:a.indicatorColor}:void 0;return P("i",{style:v,class:M("indicator",{active:o})},null)},se=()=>{if(h.indicator)return h.indicator({active:w.value,total:i.value});if(a.showIndicators&&i.value>1)return P("div",{class:M("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(oe)])};return L({prev:te,next:B,state:e,resize:X,swipeTo:ne}),O({size:n,props:a,count:i,activeIndicator:w}),T(()=>a.initialSwipe,t=>p(+t)),T(i,()=>p(e.active)),T(()=>a.autoplay,x),T([ue,re],X),T(ve(),t=>{t==="visible"?x():b()}),q(p),fe(()=>p(e.active)),pe(()=>p(e.active)),de(b),he(b),()=>{var t;return P("div",{ref:u,class:M()},[P("div",{style:Z.value,class:M("track",{vertical:a.vertical}),onTouchstart:ae,onTouchmove:ie,onTouchend:N,onTouchcancel:N},[(t=h.default)==null?void 0:t.call(h)]),se()])}}});const $e=K(be),[xe,Se]=Q("swipe-item");var Te=U({name:xe,setup(a,{slots:C}){let h;const u=j({offset:0,inited:!1,mounted:!1}),{parent:e,index:l}=ge(J);if(!e)return;const m=d(()=>{const n={},{vertical:r}=e.props;return e.size.value&&(n[r?"height":"width"]=`${e.size.value}px`),u.offset&&(n.transform=`translate${r?"Y":"X"}(${u.offset}px)`),n}),O=d(()=>{const{loop:n,lazyRender:r}=e.props;if(!r||h)return!0;if(!u.mounted)return!1;const f=e.activeIndicator.value,$=e.count.value-1,y=f===0&&n?$:f-1,w=f===$&&n?0:f+1;return h=l.value===f||l.value===y||l.value===w,h}),i=n=>{u.offset=n};return q(()=>{G(()=>{u.mounted=!0})}),L({setOffset:i}),()=>{var n;return P("div",{class:Se(),style:m.value},[O.value?(n=C.default)==null?void 0:n.call(C):null])}}});const Ae=K(Te);export{$e as S,Ae as a};
