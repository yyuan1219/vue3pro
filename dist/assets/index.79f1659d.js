import{c as O,d as j,q as x,b as J,au as K,a as f,n as _,m as A,U as L,t as Q,O as W,p as Z,f as $,I as B,a3 as F,w as ee}from"./index.e03d35ab.js";import{u as te,b as ae}from"./index.9f046415.js";const[oe,h]=O("rate");function le(t,s,n,r){return t>=s?{status:"full",value:1}:t+.5>=s&&n&&!r?{status:"half",value:.5}:t+1>=s&&n&&r?{status:"half",value:Math.round((t-s+1)*1e10)/1e10}:{status:"void",value:0}}const se={size:_,icon:A("star"),color:String,count:L(5),gutter:_,readonly:Boolean,disabled:Boolean,voidIcon:A("star-o"),allowHalf:Boolean,voidColor:String,touchable:Q,iconPrefix:String,modelValue:W(0),disabledColor:String};var ne=j({name:oe,props:se,emits:["change","update:modelValue"],setup(t,{emit:s}){const n=te(),[r,R]=ae(),P=x(),S=()=>t.readonly||t.disabled||!t.touchable,X=J(()=>Array(+t.count).fill("").map((a,e)=>le(t.modelValue,e+1,t.allowHalf,t.readonly)));let l,c,m=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;const p=()=>{c=F(P);const a=r.value.map(F);l=[],a.forEach((e,o)=>{m=Math.min(e.top,m),g=Math.max(e.top,g),t.allowHalf?l.push({score:o+.5,left:e.left,top:e.top,height:e.height},{score:o+1,left:e.left+e.width/2,top:e.top,height:e.height}):l.push({score:o+1,left:e.left,top:e.top,height:e.height})})},I=(a,e)=>{for(let o=l.length-1;o>0;o--)if(e>=c.top&&e<=c.bottom){if(a>l[o].left&&e>=l[o].top&&e<=l[o].top+l[o].height)return l[o].score}else{const u=e<c.top?m:g;if(a>l[o].left&&l[o].top===u)return l[o].score}return t.allowHalf?.5:1},T=a=>{!t.disabled&&!t.readonly&&a!==t.modelValue&&(s("update:modelValue",a),s("change",a))},G=a=>{S()||(n.start(a),p())},U=a=>{if(!S()&&(n.move(a),n.isHorizontal())){const{clientX:e,clientY:o}=a.touches[0];Z(a),T(I(e,o))}},Y=(a,e)=>{const{icon:o,size:u,color:y,count:N,gutter:V,voidIcon:w,disabled:i,voidColor:C,allowHalf:k,iconPrefix:E,disabledColor:z}=t,b=e+1,v=a.status==="full",d=a.status==="void",q=k&&a.value>0&&a.value<1;let H;V&&b!==+N&&(H={paddingRight:$(V)});const D=M=>{p(),T(k?I(M.clientX,M.clientY):b)};return f("div",{key:e,ref:R(e),role:"radio",style:H,class:h("item"),tabindex:i?void 0:0,"aria-setsize":N,"aria-posinset":b,"aria-checked":!d,onClick:D},[f(B,{size:u,name:v?o:w,class:h("icon",{disabled:i,full:v}),color:i?z:v?y:C,classPrefix:E},null),q&&f(B,{size:u,style:{width:a.value+"em"},name:d?w:o,class:h("icon",["half",{disabled:i,full:!d}]),color:i?z:d?C:y,classPrefix:E},null)])};return K(()=>t.modelValue),()=>f("div",{ref:P,role:"radiogroup",class:h({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstart:G,onTouchmove:U},[X.value.map(Y)])}});const ce=ee(ne);export{ce as R};
